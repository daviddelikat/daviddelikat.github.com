<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>litany against fear &curren; by nick quaranto &curren; Payment Processing with ActiveMerchant Notes</title>
   <meta name="author" content="Nick Quaranto" />
   <link href="http://feeds2.feedburner.com/LitanyAgainstFear" rel="alternate" title="RSS" type="application/rss+xml" />
   <link rel="stylesheet" href="/css/reset.css" type="text/css" media="screen, projection" />
   <link rel="stylesheet" href="/css/960.css" type="text/css" media="screen, projection" />
   <link rel="stylesheet" href="/css/text.css" type="text/css" media="screen, projection" />
   <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
   <link rel="stylesheet" href="/css/pygment_trac.css" type="text/css" media="screen, projection" />
</head>
<body>
  <div class="container_12">
    <div id="links" class="grid_2">
      <a href="/about.html">about</a>
      <a href="/projects.html">projects</a>
      <a href="http://visualcv.com/nquaranto/">resume</a>
      <a href="/talks.html">talks</a>
      <a href="/written.html">written</a>
      <br />
      <a href="mailto:nick@quaran.to">email</a>
      <a href="http://feeds2.feedburner.com/LitanyAgainstFear">rss</a>
      <a href="http://twitter.com/qrush">twitter</a>
      <a href="http://qrush.tumblr.com">tumblr</a>
      <a href="http://www.workingwithrails.com/person/14728-nick-quaranto">wwr</a>
    </div>
    <div id="main" class="grid_8">
      <h1><a href="/">litany against fear</a></h1>
      <div id="subtitle">coding with spice &curren; by nick quaranto</div>
      <hr />
      <div id="post">
  <h2><a href="/blog/2008/11/19/payment-processing-with-activemerchant-notes">
    Payment Processing with ActiveMerchant Notes
  </a></h2>
  <div id="date">published 19 Nov 2008</div>
  <p>Part of my series of notes from the <a href="http://www.voicesthatmatter.com/ruby2008/">Professional Ruby Conference</a>. <a href="http://litanyagainstfear.com/blog/2008/11/18/professional-ruby-conference-notes/">See them all here.</a></p>
<p>This is a talk by Cody Fauser from Shopify.</p>
<p>Why use it? Need money from customers to survive. Started very small and eventually morphed into Shopify. Shopify had to deal with tons of little idiosyncraies with how different clients wanted to interact with different payment gateways, so they extracted out this logic to make it easier.</p>
<p>All they wanted to do was charge money and not worry about the payment gateways. Just send the order form and ActiveMerchant handles the rest. Roughly 50% of Shopify&#8217;s gateways use PayPal Website Payments Pro. All of the gateways just <span class="caps">WORK</span>. Very easy to tell when it&#8217;s the provider&#8217;s problem because they have a lot of clients and can tell when they break.</p>
<p>The goal: A simple, uniform <span class="caps">API</span>. Another important thing is interpreting the results that come back from the gateways. AM takes care of abstracting all of the messy handling away for you. AM is essentially a universal translator. The alien languages = payment gateway&#8217;s APIs. Our language = Ruby.</p>
<p>Terminology:</p>
<ul>
	<li>Cardholder: person you want $ from</li>
	<li>Authorization: Verifies &amp; reserves funds on card</li>
	<li>Capture: Makes authorization for settlement</li>
	<li>Settlement: transfers authorized amount to your bank</li>
	<li>Sale/Purchase: authorization/capture combined</li>
	<li>Address Verification Service: Fraud protection mostly.</li>
	<li>Card Security Code: 3/4 digit code on the back of a credit card. More fraud protection since sites are forbidden from saving it</li>
	<li>Payment velocity: Keeps transaction history to keep track of scammers. They keep a hash of the credit card info and check it if the card is submitted again</li>
</ul>
<p>Authorization process takes a long time (4 seconds) and you need to be able to have enough Mongrels to handle. For the other end of the process, settlement takes a few days for the banks to deposit the money. Showing off some code now about how AR works. They use integers for cents instead of worrying about floats and rounding errors. Very simple, clean code. The difference between choosing merchants is as simple as picking the right gateway class for the merchant. The rest of the code to interact with the gateway is the same.</p>
<p>So, the benefits: it&#8217;s pretty damn simple overall. Rich credit card object that has plenty of validation and helpful methods that do pretty much anything and everything you need. (card.display_number =&gt; <span class="caps">XXXX</span>-<span class="caps">XXXX</span>-<span class="caps">XXXX</span>-1337 for example) AM takes the response from card security code checks and puts it in a form where you don&#8217;t have to think about it. The community has grown substantially&#8230;it&#8217;s open source! Most of the gateways have been implemented outside of Shopify. The project is very extensible and the development time for new gateways it quite low. It&#8217;s production ready code. Well tested, high quality code.</p>
  <hr />
  <div id="disqus">
    <div id="disqus_thread"></div><script type="text/javascript" src="http://disqus.com/forums/litanyagainstfear/embed.js"></script><noscript><a href="http://litanyagainstfear.disqus.com/?url=ref">View the discussion thread.</a></noscript><a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</div>


      <hr />
      <div id="footer">
        <a href="http://github.com/qrush/litanyagainstfear">managed by github</a>
        &curren;
        <a href="http://github.com/mojombo/jekyll">generated by jekyll</a>
        &curren;
        <a href="http://creativecommons.org/licenses/by-sa/3.0/us/">licensed by creative commons</a>
        &curren;
        <a href="http://slicehost.com">served by slicehost</a>
      </div>
    </div>
    <div id="categories" class="grid_2">
      <a href="/code.html">code (2)</a>
      <a href="/gaming.html">gaming (3)</a>
      <a href="/git.html">git (9)</a>
      <a href="/internet.html">internet (5)</a>
      <a href="/prorubyconf.html">prorubyconf (25)</a>
      <a href="/railsconf.html">railsconf (17)</a>
      <a href="/ruby.html">ruby (10)</a>
      <a href="/windows.html">windows (3)</a>
    </div>
  </div>
  <script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script>
  <script type="text/javascript">
  try {
  var pageTracker = _gat._getTracker("UA-2896263-1");
  pageTracker._trackPageview();
  } catch(err) {}</script>
</body>
</html>
