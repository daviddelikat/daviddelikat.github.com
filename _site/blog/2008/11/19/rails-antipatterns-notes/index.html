<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>litany against fear &curren; by nick quaranto &curren; Rails AntiPatterns Notes</title>
   <meta name="author" content="Nick Quaranto" />
   <link href="http://feeds2.feedburner.com/LitanyAgainstFear" rel="alternate" title="RSS" type="application/rss+xml" />
   <link rel="stylesheet" href="/css/reset.css" type="text/css" media="screen, projection" />
   <link rel="stylesheet" href="/css/960.css" type="text/css" media="screen, projection" />
   <link rel="stylesheet" href="/css/text.css" type="text/css" media="screen, projection" />
   <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
   <link rel="stylesheet" href="/css/pygment_trac.css" type="text/css" media="screen, projection" />
</head>
<body>
  <div class="container_12">
    <div id="links" class="grid_2">
      <a href="/about.html">about</a>
      <a href="/projects.html">projects</a>
      <a href="http://visualcv.com/nquaranto/">resume</a>
      <a href="/talks.html">talks</a>
      <a href="/written.html">written</a>
      <br />
      <a href="mailto:nick@quaran.to">email</a>
      <a href="http://feeds2.feedburner.com/LitanyAgainstFear">rss</a>
      <a href="http://twitter.com/qrush">twitter</a>
      <a href="http://qrush.tumblr.com">tumblr</a>
      <a href="http://www.workingwithrails.com/person/14728-nick-quaranto">wwr</a>
    </div>
    <div id="main" class="grid_8">
      <h1><a href="/">litany against fear</a></h1>
      <div id="subtitle">coding with spice &curren; by nick quaranto</div>
      <hr />
      <div id="post">
  <h2><a href="/blog/2008/11/19/rails-antipatterns-notes">
    Rails AntiPatterns Notes
  </a></h2>
  <div id="date">published 19 Nov 2008</div>
  <p>Part of my series of notes from the <a href="http://www.voicesthatmatter.com/ruby2008/">Professional Ruby Conference</a>. <a href="http://litanyagainstfear.com/blog/2008/11/18/professional-ruby-conference-notes/">See them all here.</a></p>
<p>This talk is from Chad Pytel and Tammer Saleh from Thoughtbot.</p>
<p>They&#8217;re gonna talk about things that they&#8217;ve seen that have gone wrong in the Rails world. It&#8217;s not gonna teach you to do <span class="caps">TDD</span>. It&#8217;s gonna show you how to fix code better.</p>
<p>Move code from controller to the model. 14 lines is <span class="caps">TOO</span> long for the create action. Might be crazy but you need to keep your guard up. Some crazy stuff is going on in this method. Transaction, catching an exception too. Refactored so it&#8217;s a bit smaller, but not ideal yet. Refactor by identifying parts of code that are identical. Try to weed out unnecessary code too. Use AR callbacks when you can, a <span class="caps">LOT</span> easier. DO <span class="caps">WHAT</span> <span class="caps">YOU</span> <span class="caps">MEAN</span>. Have expressive callback names. Constantly check for code that isn&#8217;t needed. Don&#8217;t violate the Law of Demeter&#8230;keep things <span class="caps">DRY</span> and look into the rule when you can. Use conditional callbacks in Rails 2.1 to remove even <span class="caps">MORE</span> code. Once again, push actions down into callbacks when possible. Get rid of transactions if you can. Only rescue exceptions if they are truly exceptional!</p>
<p>Putting too much domain knowledge in the controllers is <span class="caps">BAD</span>. They move state checking out of the controller and into the model by defining a hash and dynamically creating methods to check the state. Tackle large refactoring iteratively! Shove business logic into the model. <span class="caps">DRY</span> <span class="caps">DRY</span> <span class="caps">DRY</span>. Use named scopes instead of having complex finders in your controllers.</p>
<p>User Roles. See them all the time in apps. Ugly, messy, thoughtless code. Instead of having a role model, use boolean fields if you only have a small number of roles. If more than that, use has_many and not <span class="caps">HABTM</span>. Don&#8217;t build beyond the requirements and don&#8217;t jump to models prematurely.</p>
<p>Bad code happens to good people. This was all production code that they definitely wrote, but looked like crap 3-6 months down the line. The real lesson is to always be refactoring.</p>
  <hr />
  <div id="disqus">
    <div id="disqus_thread"></div><script type="text/javascript" src="http://disqus.com/forums/litanyagainstfear/embed.js"></script><noscript><a href="http://litanyagainstfear.disqus.com/?url=ref">View the discussion thread.</a></noscript><a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</div>


      <hr />
      <div id="footer">
        <a href="http://github.com/qrush/litanyagainstfear">managed by github</a>
        &curren;
        <a href="http://github.com/mojombo/jekyll">generated by jekyll</a>
        &curren;
        <a href="http://creativecommons.org/licenses/by-sa/3.0/us/">licensed by creative commons</a>
        &curren;
        <a href="http://slicehost.com">served by slicehost</a>
      </div>
    </div>
    <div id="categories" class="grid_2">
      <a href="/code.html">code (2)</a>
      <a href="/gaming.html">gaming (3)</a>
      <a href="/git.html">git (9)</a>
      <a href="/internet.html">internet (5)</a>
      <a href="/prorubyconf.html">prorubyconf (25)</a>
      <a href="/railsconf.html">railsconf (17)</a>
      <a href="/ruby.html">ruby (10)</a>
      <a href="/windows.html">windows (3)</a>
    </div>
  </div>
  <script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script>
  <script type="text/javascript">
  try {
  var pageTracker = _gat._getTracker("UA-2896263-1");
  pageTracker._trackPageview();
  } catch(err) {}</script>
</body>
</html>
